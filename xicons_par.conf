input {
	file {
			type => "named_pipe"
			path => ["C:/Users/Administrator/Documents/IMGZERO/*.tmp"]
			#path => ["/home/julian/dlogstash/sdata/zXm.*"]
			#tags => ["xmltest"]
			#add_field => {"log_type" => "spc"}
			#add_field => {"promo_desc" => "NO PROMO CODE"}		
	}
}

filter {
   grok {
     patterns_dir => ["patterns"]
     match => [ "message", "%{PAR_ICON}" ]
   }
	
	mutate {
		gsub => [ "path", "C:/Users/Administrator/Documents/IMGZERO/PAR_4.", "" ]
		gsub => [ "path", ".tmp", "" ]
	}
	
	mutate {
		add_field => {"xdate" => "%{path}"}
	}
	mutate {
		add_field => {"xdate_time" => "%{path}17:00:00.000"}
	}
	
	date {
        match => ["xdate_time" , "yyyyMMddHH:mm:ss.SSS"]
        target => "@timestamp"
   }
   
   #date {
   #     match => ["xdate_time" , "yyyyMMddHH:mm:ss.SSS"]
	#	target => "trx_date"
	#	
   #}
   
	mutate {
		convert => {"kode_cab" => "integer"}
	}
	
	mutate {
		convert => {"kode_cab" => "string"}
	}
	mutate {
		convert => {"trx_count" => "integer"}
	}
   
   translate {
			field => "[kode_cab]"
			destination => "[kode_wil]"
			dictionary => {				
			"0"=>"99"
			"1"=>"12"
			"2"=>"4"
			"3"=>"3"
			"4"=>"17"
			"5"=>"1"
			"6"=>"1"
			"7"=>"7"
			"8"=>"2"
			"9"=>"2"
			"10"=>"3"
			"11"=>"17"
			"12"=>"1"
			"13"=>"5"
			"14"=>"6"
			"15"=>"9"
			"17"=>"15"
			"18"=>"11"
			"19"=>"4"
			"20"=>"2"
			"21"=>"17"
			"22"=>"10"
			"23"=>"9"
			"24"=>"12"
			"25"=>"3"
			"26"=>"4"
			"27"=>"2"
			"28"=>"17"
			"30"=>"18"
			"31"=>"4"
			"32"=>"1"
			"34"=>"8"
			"35"=>"9"
			"37"=>"15"
			"38"=>"8"
			"39"=>"11"
			"40"=>"1"
			"41"=>"7"
			"42"=>"6"
			"43"=>"5"
			"44"=>"17"
			"45"=>"2"
			"46"=>"14"
			"48"=>"3"
			"49"=>"9"
			"50"=>"1"
			"51"=>"2"
			"53"=>"1"
			"55"=>"2"
			"56"=>"6"
			"57"=>"5"
			"59"=>"2"
			"60"=>"10"
			"61"=>"14"
			"62"=>"8"
			"63"=>"10"
			"64"=>"1"
			"65"=>"9"
			"66"=>"8"
			"67"=>"2"
			"68"=>"11"
			"69"=>"4"
			"70"=>"12"
			"71"=>"6"
			"72"=>"17"
			"73"=>"17"
			"74"=>"4"
			"76"=>"10"
			"77"=>"6"
			"78"=>"2"
			"80"=>"7"
			"81"=>"14"
			"82"=>"18"
			"83"=>"6"
			"84"=>"17"
			"85"=>"4"
			"87"=>"4"
			"88"=>"1"
			"89"=>"15"
			"90"=>"1"
			"91"=>"18"
			"93"=>"1"
			"94"=>"10"
			"95"=>"15"
			"96"=>"17"
			"97"=>"11"
			"98"=>"6"
			"100"=>"7"
			"101"=>"7"
			"102"=>"4"
			"103"=>"4"
			"105"=>"1"
			"106"=>"11"
			"107"=>"2"
			"108"=>"9"
			"109"=>"18"
			"110"=>"3"
			"111"=>"3"
			"113"=>"18"
			"114"=>"1"
			"116"=>"3"
			"117"=>"6"
			"118"=>"4"
			"119"=>"18"
			"120"=>"10"
			"121"=>"18"
			"123"=>"6"
			"124"=>"6"
			"125"=>"14"
			"126"=>"12"
			"128"=>"9"
			"130"=>"12"
			"131"=>"4"
			"133"=>"11"
			"135"=>"3"
			"136"=>"4"
			"137"=>"5"
			"138"=>"17"
			"139"=>"11"
			"140"=>"2"
			"142"=>"3"
			"145"=>"5"
			"146"=>"5"
			"147"=>"2"
			"148"=>"1"
			"151"=>"9"
			"155"=>"9"
			"156"=>"1"
			"158"=>"3"
			"166"=>"9"
			"168"=>"7"
			"169"=>"5"
			"172"=>"12"
			"178"=>"2"
			"179"=>"4"
			"180"=>"4"
			"181"=>"15"
			"182"=>"4"
			"183"=>"18"
			"184"=>"9"
			"185"=>"1"
			"188"=>"11"
			"190"=>"8"
			"191"=>"17"
			"193"=>"1"
			"197"=>"11"
			"200"=>"9"
			"203"=>"7"
			"204"=>"3"
			"205"=>"9"
			"207"=>"17"
			"209"=>"12"
			"216"=>"18"
			"217"=>"7"
			"220"=>"11"
			"221"=>"9"
			"222"=>"11"
			"223"=>"3"
			"224"=>"6"
			"225"=>"9"
			"227"=>"17"
			"228"=>"17"
			"229"=>"8"
			"230"=>"6"
			"231"=>"9"
			"232"=>"3"
			"233"=>"10"
			"234"=>"9"
			"235"=>"18"
			"236"=>"4"
			"237"=>"12"
			"240"=>"1"
			"242"=>"18"
			"243"=>"15"
			"244"=>"5"
			"245"=>"2"
			"248"=>"7"
			"251"=>"14"
			"252"=>"5"
			"253"=>"18"
			"254"=>"4"
			"255"=>"6"
			"257"=>"9"
			"258"=>"6"
			"259"=>"10"
			"261"=>"5"
			"264"=>"8"
			"265"=>"1"
			"268"=>"16"
			"269"=>"4"
			"270"=>"4"
			"271"=>"4"
			"273"=>"14"
			"274"=>"17"
			"276"=>"6"
			"278"=>"9"
			"279"=>"16"
			"280"=>"3"
			"282"=>"1"
			"284"=>"8"
			"285"=>"14"
			"288"=>"18"
			"289"=>"3"
			"290"=>"8"
			"292"=>"18"
			"293"=>"3"
			"294"=>"3"
			"295"=>"3"
			"296"=>"4"
			"297"=>"9"
			"298"=>"16"
			"299"=>"16"
			"300"=>"16"
			"301"=>"7"
			"302"=>"8"
			"303"=>"3"
			"304"=>"2"
			"306"=>"9"
			"307"=>"7"
			"308"=>"9"
			"309"=>"15"
			"310"=>"14"
			"311"=>"15"
			"312"=>"5"
			"313"=>"14"
			"314"=>"17"
			"315"=>"18"
			"316"=>"9"
			"317"=>"11"
			"318"=>"9"
			"319"=>"6"
			"320"=>"9"
			"601"=>"1"
			"602"=>"2"
			"603"=>"3"
			"604"=>"4"
			"605"=>"5"
			"606"=>"6"
			"607"=>"7"
			"608"=>"8"
			"609"=>"9"
			"610"=>"10"
			"611"=>"11"
			"612"=>"12"
			"614"=>"14"
			"615"=>"15"
			"616"=>"16"
			"617"=>"17"
			"618"=>"18"
			"619"=>"19"
			"651"=>"98"
			"652"=>"98"
			"653"=>"98"
			"654"=>"98"
			"656"=>"98"
			"657"=>"98"
			"700"=>"20"
			"701"=>"20"
			"711"=>"20"
			"712"=>"20"
			"715"=>"20"
			"716"=>"20"
			"717"=>"20"
			"718"=>"20"
			"719"=>"20"
			"720"=>"20"
			"721"=>"20"
			"722"=>"20"
			"723"=>"20"
			"724"=>"20"
			"725"=>"20"
			"726"=>"20"
			"727"=>"20"
			"728"=>"20"
			"729"=>"20"
			"730"=>"20"
			"731"=>"20"
			"734"=>"20"
			"735"=>"20"
			"736"=>"20"
			"737"=>"20"
			"738"=>"20"
			"740"=>"20"
			"741"=>"20"
			"742"=>"20"
			"743"=>"20"
			"744"=>"20"
			"745"=>"20"
			"746"=>"20"
			"747"=>"20"
			"748"=>"20"
			"749"=>"20"
			"750"=>"20"
			"751"=>"20"
			"752"=>"20"
			"753"=>"20"
			"754"=>"20"
			"755"=>"20"
			"756"=>"20"
			"757"=>"20"
			"758"=>"20"
			"759"=>"20"
			"760"=>"20"
			"761"=>"20"
			"762"=>"20"
			"763"=>"20"
			"766"=>"20"
			"767"=>"20"
			"768"=>"20"
			"769"=>"20"
			"770"=>"20"
			"771"=>"20"
			"772"=>"20"
			"773"=>"20"
			"774"=>"20"
			"775"=>"20"
			"776"=>"20"
			"777"=>"20"
			"778"=>"20"
			"779"=>"20"
			"783"=>"20"
			"787"=>"20"
			"788"=>"20"
			"789"=>"20"
			"790"=>"20"
			"791"=>"20"
			"799"=>"20"
			"800"=>"13"
			"801"=>"13"
			"802"=>"13"
			"803"=>"13"
			"804"=>"13"
			"805"=>"13"
			"806"=>"13"
			"807"=>"13"
			"808"=>"13"
			"809"=>"13"
			"810"=>"13"
			"811"=>"13"
			"812"=>"13"
			"813"=>"13"
			"814"=>"13"
			"815"=>"13"
			"816"=>"13"
			"817"=>"13"
			"818"=>"13"
			"819"=>"13"
			"820"=>"13"
			"821"=>"13"
			"822"=>"13"
			"823"=>"13"
			"824"=>"13"
			"825"=>"13"
			"826"=>"13"
			"827"=>"13"
			"828"=>"13"
			"829"=>"13"
			"830"=>"13"
			"831"=>"13"
			"832"=>"13"
			"833"=>"13"
			"834"=>"13"
			"835"=>"13"
			"836"=>"13"
			"837"=>"13"
			"838"=>"13"
			"839"=>"13"
			"840"=>"13"
			"841"=>"13"
			"842"=>"13"
			"843"=>"13"
			"844"=>"13"
			"845"=>"13"
			"846"=>"13"
			"847"=>"13"
			"848"=>"13"
			"849"=>"13"
			"850"=>"13"
			"858"=>"13"
			"859"=>"13"
			"860"=>"13"
			"861"=>"13"
			"862"=>"13"
			"863"=>"13"
			"864"=>"13"
			"865"=>"13"
			"866"=>"13"
			"867"=>"13"
			"868"=>"13"
			"869"=>"13"
			"870"=>"13"
			"871"=>"13"
			"872"=>"13"
			"873"=>"13"
			"874"=>"13"
			"875"=>"13"
			"876"=>"13"
			"877"=>"13"
			"880"=>"13"
			"881"=>"13"
			"882"=>"13"
			"883"=>"13"
			"884"=>"13"
			"885"=>"13"
			"886"=>"13"
			"887"=>"13"
			"888"=>"13"
			"889"=>"13"
			"890"=>"13"
			"893"=>"13"
			"894"=>"13"
			"896"=>"13"
			"897"=>"13"
			"898"=>"13"
		}
   }
   
   translate {
			field => "[kode_wil]"
			destination => "[wil_desc]"
			dictionary => {
				"1"=>"WMD"
				"2"=>"WPD"
				"3"=>"WPL"
				"4"=>"WBN"
				"5"=>"WSM"
				"6"=>"WSY"
				"7"=>"WMK"
				"8"=>"WDR"
				"9"=>"WBJ"
				"10"=>"WJS"
				"11"=>"WMO"
				"12"=>"WJK"
				"14"=>"WJB"
				"15"=>"WJY"
				"16"=>"WPU"
				"17"=>"WYK"
				"18"=>"WMA"
			}
	}

   mutate { 
		remove_field => ["tags", "message","path","@version", "type", "host", "tdate"]
   }
}

output {
   stdout { codec => rubydebug }
   elasticsearch {
      hosts => [ "192.168.99.40:9200"]
      index => "par4-%{xdate}"
      user => "ls23" 
      password => "bniy2k"
   }
}